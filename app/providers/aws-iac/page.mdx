# AWS IAC

## Use AWS with Infrastructure As Code

To deploy and manage infrastructure on AWS, you'll need to set up AWS credentials with programmatic access. This involves creating an IAM user with the necessary permissions and obtaining AWS Access Keys.

## Prerequisites

- An AWS account
- Administrative access to create IAM users and policies

## Step 1: Create an IAM User

1. Sign in to the [AWS Management Console](https://console.aws.amazon.com/)
2. Navigate to **IAM** (Identity and Access Management)
3. In the left sidebar, click **Users**
4. Click **Create user**
5. Enter a username (e.g., `terraform-user` or `iac-deployment-user`)
6. Select **Programmatic access** for access type
7. Click **Next: Permissions**

## Step 2: Attach Policies

For infrastructure management, you'll need appropriate permissions. Choose one of the following approaches:

### Option A: Full Administrative Access (Simplest)
- Attach the **AdministratorAccess** policy
- ⚠️ **Warning**: This grants full access to your AWS account. Only use for development/testing.

### Option B: Custom Policy (Recommended for Production)
Create a custom policy with only the permissions your infrastructure needs:

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "ec2:*",
                "s3:*",
                "lambda:*",
                "iam:*",
                "cloudformation:*",
                "route53:*",
                "acm:*"
            ],
            "Resource": "*"
        }
    ]
}
```

## Step 3: Get Your Access Keys

1. Click **Next: Tags** (optional)
2. Click **Next: Review**
3. Click **Create user**
4. **Important**: Copy both the **Access Key ID** and **Secret Access Key**
5. Store these securely - the secret key will not be shown again

## Step 4: Configure Your Environment

### Option A: Environment Variables
Set these environment variables in your terminal or CI/CD system:

```bash
export AWS_ACCESS_KEY_ID="your-access-key-id"
export AWS_SECRET_ACCESS_KEY="your-secret-access-key"
export AWS_DEFAULT_REGION="us-east-1"  # or your preferred region
```

### Option B: AWS CLI Configuration
If you have the AWS CLI installed:

```bash
aws configure
```

Enter your credentials when prompted.

### Option C: Terraform/IaC Tool Configuration
Most Infrastructure as Code tools support these environment variables automatically, or you can configure them in your tool's configuration files.

## Security Best Practices

1. **Rotate Keys Regularly**: Create new access keys every 90 days
2. **Use Least Privilege**: Only grant the minimum permissions needed
3. **Never Commit Keys**: Keep access keys out of version control
4. **Use IAM Roles**: For EC2 instances, use IAM roles instead of access keys
5. **Enable MFA**: Consider requiring MFA for the IAM user
6. **Monitor Usage**: Use AWS CloudTrail to monitor API calls

## Verification

Test your credentials work:

```bash
aws sts get-caller-identity
```

This should return your user details if credentials are configured correctly.

## Next Steps

With your AWS credentials configured, you can now:
- Deploy infrastructure using Terraform, CDK, or CloudFormation
- Use AWS services programmatically
- Set up CI/CD pipelines for automated deployments